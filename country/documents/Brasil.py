import os
import datetime
from config import datareal
from select.BRA import empresas_nfe
from select.BRA import empresas_nfse
from select.BRA import nota_select_nfe
from select.BRA import nota_select_nfse

ct = datetime.datetime.now()
ct = str(ct.year) + '_' + str(ct.month) + '_' + str(ct.day) + '_' + str(ct.hour) + '_' + str(ct.minute) + '_' + str(ct.second)

def BRA_NFE():

    xnome, cnpj, xuf = empresas_nfe.select_company()
    folio, serie = nota_select_nfe.nota_select()

    f = open('idoc/outbound' + str(ct) + '.idoc', 'w', encoding='utf-8-sig')
    f.write('EDI_DC40  8000000000003261888740 3012  ZKFBC_NFE_200                                               ZKFBC_NFE_OUT_200                                SAPKFQ    LS  KFQCLNT800                                                                                           TFC01     LS  TFC01                                                                                                '+ str(datareal.datacompleta) +'172849                                                                                                                '+ str(datareal.datacompleta) +'172849     \n')
    f.write('ZKFBC_NFE_200_IDE000          800000000000326188800000100000001'+ str(xuf) +'60773642Venda merc.adq.receb.de terceiros                            55'+ str(serie) + str(folio) + str(datareal.datacompletaseparada) + str(datareal.datacompletaseparada) + str(datareal.horacompleta) +'135503081142104.00                                                                                     0000006967                                                                                                     '+ str(datareal.datacompletaseparada) +'T'+ str(datareal.horacompleta) +'                         1194.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n')
    f.write('ZKFBC_NFE_200_EMIT000         800000000000326188800000200000001'+ str(cnpj) +'           '+ str(xnome) +'                                                            956224310481                00674281                      3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n')
    f.write('ZKFBC_NFE_200_ENDEREMIT000    800000000000326188800000300000202R Guararapes                                                2064                                                                                                                    Casa verde                                                  3550308Sao Paulo                                                   SP045610041058Brasil                                                              00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \n')
    f.write('ZKFBC_NFE_200_AVULSA000       800000000000326188800000400000001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_NFE_200_DEST000         80000000000032618880000050000000124492961000129           Cliente BR 10726059000115                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \n')
    f.write('ZKFBC_NFE_200_ENDERDEST000    800000000000326188800000600000502Alameda Rio Negro                                           161                                                                                                                     N/D                                                         3550308Barueri                                                     SP064540001058Brasil                                                                    9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n')
    f.write('ZKFBC_NFE_200_RETIRADA000     800000000000326188800000700000001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_NFE_200_ENTREGA000      800000000000326188800000800000001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_NFE_200_DET000          800000000000326188800000900000002    1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_NFE_200_PROD000         800000000000326188800001000000903CXPAPELAO                                                   SEM GTIN      CAIXA DE PAPELAO 210X140X140 MM                                                                                         40169300   5102PEÇ   1.000               100.000000            100.00          SEM GTIN      KG    1.000               100.000000                                                                            1CA-653267      000000000010                                          2806100  00000000000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n')
    f.write('ZKFBC_NFE_200_MED000          800000000000326188800001100001004                                                               0.00 000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n')
    f.write('ZKFBC_NFE_200_IMPOSTO000      800000000000326188800001200000903000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \n')
    f.write('ZKFBC_NFE_200_ICMS000         800000000000326188800001300001204000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \n')
    f.write('ZKFBC_NFE_200_ICMS40000       8000000000003261888000014000013050400.00             000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n')
    f.write('ZKFBC_NFE_200_IPI000          800000000000326188800001500001204     24492961000129                                                                      107000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \n')
    f.write('ZKFBC_NFE_200_IPITRIB000      800000000000326188800001600001505500.00            0.00                                   0.00            000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \n')
    f.write('ZKFBC_NFE_200_PIS000          800000000000326188800001700001204000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \n')
    f.write('ZKFBC_NFE_200_PISNT000        80000000000032618880000180000170508000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \n')
    f.write('ZKFBC_NFE_200_COFINS000       800000000000326188800001900001204000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 \n')
    f.write('ZKFBC_NFE_200_COFINSNT000     80000000000032618880000200000190508000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \n')
    f.write('ZKFBC_NFE_200_ITEMEXT000      800000000000326188800002100000903DetExtNroItem                                                                                                                                                                                                                                                 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                000010                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFE_200_ITEMEXT000      800000000000326188800002200000903DetExtAFN_02                                                                                                                                                                                                                                               040                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 000010                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFE_200_ITEMEXT000      800000000000326188800002300000903DetExtAFN_03                                                                                                                                                                                                                                               40                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  000010                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFE_200_ITEMEXT000      800000000000326188800002400000903DetExtAFN_05                                                                                                                                                                                                                                               50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  000010                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFE_200_ITEMEXT000      800000000000326188800002500000903DetExtNUE_06                                                                                                                                                                                                                                               50                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  000010                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFE_200_TOTAL000        800000000000326188800002600000001X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n')
    f.write('ZKFBC_NFE_200_ICMSTOT000      8000000000003261888000027000026020.00            0.00            0.00            0.00            100.00          0.00            0.00            0.00            0.00            0.00            0.00            0.00            0.00            100.00                                                                                          0.00            0.00                            0.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \n')
    f.write('ZKFBC_NFE_200_TRANSP000       8000000000003261888000028000000019                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n')
    f.write('ZKFBC_NFE_200_TRANSPORTA000   800000000000326188800002900002802                         DESTINATARIO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFE_200_VOL000          80000000000032618880000300000280200001     VOLUMES                                                                                                                                                                             15000.000       15000.000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                \n')
    f.write('ZKFBC_NFE_200_PAG000          800000000000326188800003100000002                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_NFE_400_DETPAG000       80000000000032618880000320000310399100.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               \n')
    f.write('ZKFBC_NFE_200_INFADIC000      800000000000326188800003300000001X                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n')
    f.write('ZKFBC_NFE_200_INFCPL000       800000000000326188800003400003302  Isento ou não sujeito a ICMS  Cofins Operação sem Incidência da Contribuição L1 Cofins Operação sem Incidência da Contribuição L3 Cofins Operação sem Incidência da Contribuição L4  PIS Operação sem Incidência da Contribuição linha 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             \n')
    f.write('ZKFBC_NFE_200_CABEXT000       800000000000326188800003500000002SYSTEM                                                                                                                                                                                                                                                     KFQ-2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_TF_CONTROL000           8000000000003261888000036000000010000006967                                                  1    NFE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \n')
    f.close()

def BRA_NFSE():

    xMun, cnpj, inscxmun, xnome, xuf, xcep = empresas_nfse.select_company()
    rps, serie = nota_select_nfse.nota_select()

    f = open('idoc/outbound.idoc', 'w', encoding='utf-8-sig')
    f.write('EDI_DC40  6000000000018161852731 3012  ZKFBC_NFSE_COMPNFSE                                         ZKFBC_NFSE                                       SAPKFQ    LS  P60600                                                                                               KFCBTF0002LS  TRUSTFILES                                                                                           '+ str(datareal.datacompleta) +'103754                                                                                                                '+ str(datareal.datacompleta) +'103754      \n')
    f.write('ZKFBC_NFSE_NFSE000            600000000001816185200000100000001'+ str(docnum) +'                                                  25580 010007018'+ str(datareal.datacompleta) + str(datareal.datacompleta) + str(datareal.horacompleta) +'135308051162104.00                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \n')
    f.write('ZKFBC_NFSE_INFNFSE000         600000000001816185200000200000102                        '+ str(datareal.datacompleta)+ '-'+ str(datareal.dia) +'T00:00:00'+ str(datareal.datacompleta)+ '-'+ str(datareal.dia) +'T'+ str(datareal.horacompleta) +'1 22                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n')
    f.write('ZKFBC_NFSE_IDENTIFICACAORPS000600000000001816185200000300000203'+ str(rps) + str(serie) +'1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \n')
    f.write('ZKFBC_NFSE_SERVICO000         600000000001816185200000400000203010901      010901              '+ str(inscxmun) +'000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n')
    f.write('ZKFBC_NFSE_VALORES000         6000000000018161852000005000004043024.00                                                                                                                       2151.20                                                3024.00           5.00      3024.00                                               000010                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n')
    f.write('ZKFBC_NFSE_DISCRIMINACAO000   600000000001816185200000600000404| Vogue - Outras rec - Produç o - Online                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          000010\n')
    f.write('ZKFBC_NFSE_PRESTADORSERVICO000600000000001816185200000700000203'+ str(cnpj) + str(inscxmun) + str(xnome) +'                                                            Av. Nove de Julho                                                                                                            5229                                                                  Jardim Paulista                                             '+ str(inscxmun) + str(xuf) + str(xcep) +'2125345000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \n')
    f.write('ZKFBC_NFSE_TOMADORSERVICO000  600000000001816185200000800000203           '+ str(cnpj) + str(inscxmun) + str(xnome) +'                                                               BRICKELL KEY DRIVE                                                                                                           601                                                                   EXTERIOR                                                 '+ str(inscxmun) + str(xuf) + str(xcep) +'2123808236                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n')
    f.write('ZKFBC_NFSE_INTERMEDIARIOSER000600000000001816185200000900000203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \n')
    f.write('ZKFBC_NFSE_ORGAOGERADOR000    600000000001816185200001000000203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \n')
    f.write('ZKFBC_NFSE_CONSTRUCAOCIVIL000 600000000001816185200001100000203                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        \n')
    f.close()
